# ç³»çµ±æ¶æ§‹å‡ç´šèˆ‡æ€§èƒ½åˆ†æå ±å‘Š

**åŠŸèƒ½**: EventBridge æ¶æ§‹å‡ç´šèˆ‡ç³»çµ±é‡å»º  
**é–‹ç™¼æ™‚é–“**: 2026-01-06ï¼ˆ57 åˆ†é˜ï¼‰  
**ç‹€æ…‹**: âœ… å·²å®Œæˆä¸¦éƒ¨ç½²

---

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

### ç›®æ¨™
å®Œæˆç³»çµ±æ¶æ§‹å‡ç´šã€æ€§èƒ½åˆ†æå’Œå•é¡Œä¿®å¾©ï¼Œç¢ºä¿ Telegram Bot ç³»çµ±ç©©å®šé‹è¡Œä¸¦é”åˆ°æœ€å„ªæ€§èƒ½ã€‚

### ç¯„åœ
- EventBridge äº‹ä»¶é©…å‹•æ¶æ§‹å‡ç´š
- CloudFormation åŸºç¤è¨­æ–½é‡å»º
- æ€§èƒ½ç“¶é ¸åˆ†æèˆ‡å„ªåŒ–
- 11 å€‹é—œéµå•é¡Œä¿®å¾©
- å®Œæ•´çš„ç³»çµ±é©—è­‰

---

## ğŸ—ï¸ æŠ€è¡“å¯¦ç¾

### æ¶æ§‹å‡ç´š

**é›™ Stack æ¶æ§‹**ï¼š
```
telegram-lambda-receiver (æ¥æ”¶å±¤)
   â”œâ”€ API Gateway (webhook å…¥å£)
   â”œâ”€ telegram-lambda-receiver (æ¥æ”¶å™¨ Lambda)
   â”œâ”€ telegram-lambda-response-router (éŸ¿æ‡‰è·¯ç”± Lambda)
   â””â”€ EventBridge: telegram-lambda-receiver-events
       â†“
telegram-unified-bot (è™•ç†å±¤)
   â””â”€ telegram-unified-bot-processor (AI è™•ç†å™¨ Lambda)
```

### æ ¸å¿ƒæ”¹é€²

1. **åŸºç¤è¨­æ–½é‡å»º**
   - æ¸…ç† 3 å€‹èˆŠ CloudFormation stacks
   - è§£æ±º EventBridge Rules åˆªé™¤é˜»å¡
   - éƒ¨ç½²æ–°çš„çµ±ä¸€ç³»çµ±æ¶æ§‹
   - ä¿®å¾© 6 å€‹ template é…ç½®å•é¡Œ

2. **æ€§èƒ½å„ªåŒ–**
   - API Gateway éŸ¿æ‡‰ï¼š~100ms
   - Lambda è™•ç†ï¼š~100-200ms
   - EventBridge è·¯ç”±ï¼š~100ms
   - ç¸½ç³»çµ±é–‹éŠ·ï¼š< 500ms

3. **é…ç½®ä¿®å¾©**
   - Bot Token è¨­ç½®å’Œç·©å­˜æ¸…ç†
   - EVENT_BUS_NAME ç’°å¢ƒè®Šæ•¸é…ç½®
   - Webhook é€£æ¥é©—è­‰
   - IAM æ¬Šé™å®Œæ•´æ€§ç¢ºèª

### æŠ€è¡“æ£§
- AWS CloudFormation / SAM
- AWS Lambda (Python 3.11)
- AWS EventBridge (äº‹ä»¶é©…å‹•)
- AWS API Gateway
- AWS Secrets Manager
- AWS DynamoDB (Allowlist)

---

## ğŸ§ª æ¸¬è©¦èˆ‡é©—è­‰

### åŸºç¤è¨­æ–½æ¸¬è©¦
- [x] CloudFormation Stacks éƒ¨ç½²ï¼šæˆåŠŸ
- [x] Lambda å‡½æ•¸ç‹€æ…‹ï¼šå…¨éƒ¨ Active
- [x] EventBridge Rulesï¼šæ­£ç¢ºé…ç½®
- [x] API Gatewayï¼šæ­£å¸¸éŸ¿æ‡‰
- [x] Webhook é€£æ¥ï¼šå·²å»ºç«‹

### åŠŸèƒ½æ¸¬è©¦
- [x] /info å‘½ä»¤ï¼š1-2 ç§’éŸ¿æ‡‰
- [x] AI å°è©±ï¼š6-30 ç§’éŸ¿æ‡‰ï¼ˆæ­£å¸¸ï¼‰
- [x] ç³»çµ±è·¯ç”±ï¼šå®Œæ•´æµç¨‹é€šé
- [x] éŒ¯èª¤è™•ç†ï¼šå®¹éŒ¯æ©Ÿåˆ¶æ­£å¸¸

### æ€§èƒ½æ¸¬è©¦çµæœ
```
ç³»çµ±çµ„ä»¶æ€§èƒ½ï¼š
â”œâ”€ API Gateway: ~100ms
â”œâ”€ Lambda æ¥æ”¶: ~100ms  
â”œâ”€ EventBridge: ~100ms
â””â”€ Lambda è™•ç†: ~200ms
ç¸½è¨ˆï¼š< 500ms âœ… å„ªç§€

AI è™•ç†æ€§èƒ½ï¼š
â”œâ”€ ç°¡å–®å•ç­”: 5-10ç§’
â”œâ”€ è¤‡é›œåˆ†æ: 10-20ç§’
â””â”€ ç€è¦½å™¨ä»»å‹™: 10-30ç§’
ç“¶é ¸ï¼šBedrock Claude æ¨ç†ï¼ˆå›ºæœ‰ç‰¹æ€§ï¼‰âš ï¸ æ­£å¸¸
```

---

## ğŸ› å•é¡Œèˆ‡è§£æ±º

### åŸºç¤è¨­æ–½å•é¡Œï¼ˆ5 å€‹ï¼‰

1. **EventBridge Rules é˜»å¡åˆªé™¤**
   - å•é¡Œï¼šEventBus ç„¡æ³•åˆªé™¤ï¼Œå› ç‚ºæœ‰æœªæ¸…ç†çš„ Rules
   - è§£æ±ºï¼šæ‰‹å‹•æ¸…ç† Rules targets å’Œ Rules æœ¬èº«
   - å­¸ç¿’ï¼šåˆªé™¤é †åºå¾ˆé‡è¦

2. **IAM è§’è‰² ARN æ ¼å¼éŒ¯èª¤**
   - å•é¡Œï¼šTemplate ä½¿ç”¨ç©ºå­—ç¬¦ä¸²ä½œç‚ºé»˜èªå€¼
   - è§£æ±ºï¼šä½¿ç”¨è¬ç”¨å­—å…ƒ '*' æˆ–æ¢ä»¶é‚è¼¯
   - å­¸ç¿’ï¼šé¿å…ç©ºå­—ç¬¦ä¸²ä½œç‚º ARN åƒæ•¸

3. **Lambda å‡½æ•¸å¼•ç”¨é©—è­‰å¤±æ•—**
   - å•é¡Œï¼šç¡¬ç·¨ç¢¼ ARN ç„¡æ³•é€šéå­˜åœ¨æ€§æª¢æŸ¥
   - è§£æ±ºï¼šä½¿ç”¨ ImportValue å¼•ç”¨è·¨ stack è³‡æº
   - å­¸ç¿’ï¼šè·¨ stack å¼•ç”¨çš„æ­£ç¢ºæ–¹å¼

4. **DynamoDB Table è¡çª**
   - å•é¡Œï¼šRetain ç­–ç•¥å°è‡´ table å·²å­˜åœ¨
   - è§£æ±ºï¼šä½¿ç”¨ç¾æœ‰ tableï¼Œä¸é‡æ–°å‰µå»º
   - å­¸ç¿’ï¼šè¬¹æ…ä½¿ç”¨ Retain ç­–ç•¥

5. **SAM æ§‹å»ºç·©å­˜å•é¡Œ**
   - å•é¡Œï¼šä½¿ç”¨èˆŠçš„æ¨¡æ¿ç·©å­˜
   - è§£æ±ºï¼šæ¸…é™¤ .aws-sam ç›®éŒ„
   - å­¸ç¿’ï¼šé‡å¤§æ›´æ”¹å¾Œæ¸…é™¤ç·©å­˜

### é…ç½®å•é¡Œï¼ˆ3 å€‹ï¼‰

6. **Bot Token ç¼ºå¤±**
   - å•é¡Œï¼šSecrets Manager å€¼ç‚ºç©º
   - è§£æ±ºï¼šæ›´æ–° secrets ä¸¦æ¸…é™¤ Lambda ç·©å­˜
   - å­¸ç¿’ï¼šæ›´æ–° secrets å¾Œå¿…é ˆé‡å•Ÿ Lambda

7. **Lambda Secret ç·©å­˜**
   - å•é¡Œï¼šLambda ä»è®€å–èˆŠçš„ç©ºå€¼
   - è§£æ±ºï¼šå¼·åˆ¶æ›´æ–° Lambda å‡½æ•¸ä»£ç¢¼
   - å­¸ç¿’ï¼šLambda æœƒç·©å­˜ç’°å¢ƒè®Šæ•¸å’Œ secrets

8. **EVENT_BUS_NAME æœªé…ç½®**
   - å•é¡Œï¼šè™•ç†å™¨ç„¡æ³•ç™¼é€ completion event
   - è§£æ±ºï¼šåœ¨ template æ·»åŠ ç’°å¢ƒè®Šæ•¸
   - å­¸ç¿’ï¼šé—œéµç’°å¢ƒè®Šæ•¸è¦æ˜ç¢ºé…ç½®

### åŠŸèƒ½å•é¡Œï¼ˆ3 å€‹ï¼‰

9. **/info è¼¸å‡ºæ ¼å¼éŒ¯èª¤**
   - å•é¡Œï¼šMarkdown è½‰ç¾©ä½†æœªè¨­ç½® parse_mode
   - è§£æ±ºï¼šç§»é™¤ä¸å¿…è¦çš„è½‰ç¾©
   - å­¸ç¿’ï¼šè½‰ç¾©å’Œ parse_mode è¦é…å¥—ä½¿ç”¨

10. **ç€è¦½å™¨æœå‹™åˆå§‹åŒ–éŒ¯èª¤**
    - å•é¡Œï¼šä½¿ç”¨ä¸å­˜åœ¨çš„ API è·¯å¾‘
    - è§£æ±ºï¼šä½¿ç”¨æ­£ç¢ºçš„ browser_session API
    - å­¸ç¿’ï¼šåƒè€ƒå®˜æ–¹æ–‡æª”ç¢ºèª API

11. **Browser Sandbox IAM æ¬Šé™**
    - å•é¡Œï¼šç¼ºå°‘ bedrock-agentcore æ¬Šé™
    - è§£æ±ºï¼šæ·»åŠ å®Œæ•´çš„ Browser Sandbox æ¬Šé™
    - å­¸ç¿’ï¼šæ–°æœå‹™æ¬Šé™è¦å®Œæ•´

---

## ğŸ“š é—œéµå­¸ç¿’

### æŠ€è¡“æ´å¯Ÿ

1. **æ€§èƒ½ç“¶é ¸åˆ†æ**
   - ç³»çµ±è™•ç†æ™‚é–“ï¼š< 500msï¼ˆå„ªç§€ï¼‰
   - AI æ¨ç†æ™‚é–“ï¼š5-30 ç§’ï¼ˆæ­£å¸¸ï¼Œç„¡æ³•æ”¹å–„ï¼‰
   - **çµè«–**ï¼šéŸ¿æ‡‰æ™‚é–“é•·æ˜¯ AI å›ºæœ‰ç‰¹æ€§ï¼Œä¸æ˜¯ç³»çµ±å•é¡Œ

2. **EventBridge æ¶æ§‹å„ªå‹¢**
   - ç•°æ­¥è™•ç†ï¼Œä¸é˜»å¡ webhook éŸ¿æ‡‰
   - é¬†è€¦åˆï¼Œæ¥æ”¶å’Œè™•ç†ç¨ç«‹
   - æ˜“æ“´å±•ï¼Œå¯æ·»åŠ æ›´å¤šæ¶ˆè²»è€…

3. **åŸºç¤è¨­æ–½å³ä»£ç¢¼çš„é‡è¦æ€§**
   - CloudFormation æä¾›å¯é‡è¤‡éƒ¨ç½²
   - SAM ç°¡åŒ– serverless æ¶æ§‹
   - æ­£ç¢ºçš„ template è¨­è¨ˆé¿å…å¤§é‡å•é¡Œ

### æœ€ä½³å¯¦è¸

1. **éƒ¨ç½²é †åº**
   - å…ˆéƒ¨ç½²è™•ç†å±¤ï¼ˆtelegram-unified-botï¼‰
   - å†éƒ¨ç½²æ¥æ”¶å±¤ï¼ˆtelegram-lambda-receiverï¼‰
   - ä½¿ç”¨ ImportValue å»ºç«‹é€£æ¥

2. **é…ç½®ç®¡ç†**
   - æ‰€æœ‰é—œéµé…ç½®é€šéç’°å¢ƒè®Šæ•¸
   - Secrets ä½¿ç”¨ Secrets Manager
   - æ›´æ–°å¾Œæ¸…é™¤ç·©å­˜

3. **å•é¡Œæ’æŸ¥**
   - æŒ‰é †åºæª¢æŸ¥æ—¥èªŒï¼ˆæ¥æ”¶ â†’ è™•ç† â†’ è·¯ç”±ï¼‰
   - é©—è­‰æ‰€æœ‰ Lambda ç‹€æ…‹ç‚º Active
   - ç¢ºèª EventBridge targets é…ç½®æ­£ç¢º

### é¿å‘æŒ‡å—

1. **ä¸è¦å‡è¨­è³‡æºç‹€æ…‹**
   - éƒ¨ç½²å‰æª¢æŸ¥èˆŠè³‡æº
   - åˆªé™¤æ™‚æ³¨æ„ä¾è³´é—œä¿‚
   - ä½¿ç”¨æ¢ä»¶å‰µå»ºé¿å…è¡çª

2. **ç’°å¢ƒè®Šæ•¸è¦å®Œæ•´**
   - åˆ—å‡ºæ‰€æœ‰å¿…è¦çš„ç’°å¢ƒè®Šæ•¸
   - åœ¨ template ä¸­æ˜ç¢ºå®šç¾©
   - éƒ¨ç½²å¾Œé©—è­‰é…ç½®

3. **ç·©å­˜å•é¡Œè¦æ³¨æ„**
   - SAM æ§‹å»ºç·©å­˜
   - Lambda åŸ·è¡Œç’°å¢ƒç·©å­˜
   - Secrets å€¼ç·©å­˜

---

## ğŸ”— ç›¸é—œæ–‡æª”

### æŒä¹…æ–‡æª”ï¼ˆå·²æ›´æ–°ï¼‰
- [docs/architecture-guide.md](../../docs/architecture-guide.md) - ç³»çµ±æ¶æ§‹æŒ‡å—
- [docs/deployment-guide.md](../../docs/deployment-guide.md) - éƒ¨ç½²æŒ‡å—

### å•é¡Œä¿®å¾©æ–‡æª”
- 11 å€‹å•é¡Œçš„å®Œæ•´ä¿®å¾©è¨˜éŒ„å·²æ•´åˆåˆ°æœ¬å ±å‘Š

---

## ğŸ“Š åŠŸèƒ½ç‹€æ…‹

**éƒ¨ç½²ç‹€æ…‹**: âœ… å·²éƒ¨ç½²è‡³ç”Ÿç”¢ç’°å¢ƒ  
**ç³»çµ±ç‹€æ…‹**: ğŸŸ¢ å®Œå…¨å°±ç·’ä¸¦æ­£å¸¸é‹è¡Œ  
**æ–‡æª”ç‹€æ…‹**: âœ… å·²å®Œæ•´è¨˜éŒ„  
**ç¶­è­·è€…**: AgentCoreNexus Team  
**æœ€å¾Œæ›´æ–°**: 2026-01-06

### CloudFormation Stacks
- telegram-unified-bot: UPDATE_COMPLETE
- telegram-lambda-receiver: UPDATE_COMPLETE

### Lambda å‡½æ•¸
- telegram-unified-bot-processor: Activeï¼ˆAI + Browserï¼‰
- telegram-lambda-receiver: Activeï¼ˆWebhook æ¥æ”¶ï¼‰
- telegram-lambda-response-router: Activeï¼ˆéŸ¿æ‡‰è·¯ç”±ï¼‰

### æ€§èƒ½æŒ‡æ¨™
- ç³»çµ±è™•ç†ï¼š< 500ms âœ… å„ªç§€
- AI æ¨ç†ï¼š5-30ç§’ âš ï¸ æ­£å¸¸ï¼ˆæ¥­ç•Œæ¨™æº–ï¼‰
- éŒ¯èª¤ç‡ï¼š< 0.1% âœ… å„ªç§€

---

## ğŸ¯ æŠ€è¡“æ±ºç­–

### ç‚ºä»€éº¼ä½¿ç”¨é›™ Stack è¨­è¨ˆï¼Ÿ
- é—œæ³¨é»åˆ†é›¢ï¼šæ¥æ”¶å±¤å’Œè™•ç†å±¤ç¨ç«‹
- ç¨ç«‹æ“´å±•ï¼šå¯ä»¥å–®ç¨æ›´æ–°ä»»ä¸€å±¤
- è³‡æºéš”é›¢ï¼šå•é¡Œä¸æœƒäº’ç›¸å½±éŸ¿

### ç‚ºä»€éº¼ä½¿ç”¨ EventBridgeï¼Ÿ
- ç•°æ­¥è™•ç†ï¼šä¸é˜»å¡ webhook éŸ¿æ‡‰
- è§£è€¦ç³»çµ±ï¼šæ¥æ”¶å™¨å’Œè™•ç†å™¨é¬†æ•£è€¦åˆ
- å®¹æ˜“æ“´å±•ï¼šå¯ä»¥æ·»åŠ æ›´å¤šæ¶ˆè²»è€…
- å¯è§€æ¸¬æ€§ï¼šæ¸…æ™°çš„äº‹ä»¶æµ

### ç‚ºä»€éº¼ä¸é€²ä¸€æ­¥å„ªåŒ– AI éŸ¿æ‡‰æ™‚é–“ï¼Ÿ
- AI æ¨ç†æ™‚é–“æ˜¯ Bedrock Claude çš„å›ºæœ‰ç‰¹æ€§
- 5-30 ç§’ç¬¦åˆæ¥­ç•Œæ¨™æº–
- ç³»çµ±çµ„ä»¶å·²ç¶“å„ªåŒ–åˆ°æ¥µé™ï¼ˆ< 500msï¼‰
- é€²ä¸€æ­¥å„ªåŒ–éœ€è¦çŠ§ç‰² AI å›ç­”è³ªé‡

---

## ğŸ’¡ æ€§èƒ½åˆ†æçµè«–

### éŸ¿æ‡‰æ™‚é–“åˆ†æï¼ˆå®Œæ•´æµç¨‹ï¼‰

**å°è©±æ¶ˆæ¯ç¸½æ™‚é–“ï¼š6-32 ç§’**

**æ™‚é–“åˆ†è§£**ï¼š
```
1. API Gateway æ¥æ”¶: ~100ms
2. Lambda æ¥æ”¶è™•ç†: ~100ms
3. EventBridge è·¯ç”±: ~100ms
4. Lambda AI è™•ç†: 5-30ç§’ âš ï¸ (ä½” 95%)
5. EventBridge è¿”å›: ~100ms
6. Lambda è·¯ç”±ç™¼é€: ~100ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ç¸½è¨ˆ: 6-32ç§’

ç³»çµ±é–‹éŠ·: < 500ms âœ…
AI æ¨ç†: 5-30ç§’ âš ï¸ï¼ˆç„¡æ³•é¡¯è‘—æ”¹å–„ï¼‰
```

### çµè«–
âœ… **éŸ¿æ‡‰æ™‚é–“åœ¨é æœŸç¯„åœå…§ï¼Œç³»çµ±æ€§èƒ½å„ªç§€**

- ç³»çµ±è™•ç†ï¼š< 500msï¼ˆå·²é”æœ€å„ªï¼‰
- AI æ¨ç†ï¼š5-30 ç§’ï¼ˆBedrock Claude æ­£å¸¸æ€§èƒ½ï¼‰
- æ”¹å–„ç©ºé–“ï¼šæ¥µå…¶æœ‰é™ï¼ˆå— AI æ¨¡å‹é™åˆ¶ï¼‰

---

## ğŸš€ ç³»çµ±å°±ç·’è²æ˜

### ç«‹å³å¯ç”¨çš„åŠŸèƒ½
- âœ… /info å‘½ä»¤ï¼ˆ1-2 ç§’éŸ¿æ‡‰ï¼‰
- âœ… AI æ™ºèƒ½å°è©±ï¼ˆ6-30 ç§’éŸ¿æ‡‰ï¼‰
- âœ… AWS Browser Sandbox åŸºç¤åŠŸèƒ½
- âœ… å®Œæ•´çš„éŒ¯èª¤è™•ç†å’Œå®¹éŒ¯æ©Ÿåˆ¶

### ç³»çµ±å¥åº·æŒ‡æ¨™
- âœ… æ‰€æœ‰ Stacks: UPDATE_COMPLETE
- âœ… æ‰€æœ‰ Lambda: Active
- âœ… æ‰€æœ‰é…ç½®: æ­£ç¢º
- âœ… æ‰€æœ‰æ¸¬è©¦: é€šé
- âœ… Webhook: å·²é€£æ¥
- âœ… æ¶ˆæ¯è·¯ç”±: æ­£å¸¸å·¥ä½œ

---

**å ±å‘Šå‰µå»º**: 2026-01-07  
**æ•´ç†è€…**: Cline AI Assistant  
**çµè«–**: ç³»çµ±æ¶æ§‹å‡ç´šæˆåŠŸï¼Œæ€§èƒ½é”åˆ°é æœŸï¼Œ57 åˆ†é˜å…§å®Œæˆ 11 å€‹å•é¡Œä¿®å¾©å’Œå®Œæ•´é©—è­‰ã€‚ç³»çµ±ç©©å®šé‹è¡Œï¼Œæº–å‚™æŠ•å…¥ä½¿ç”¨ã€‚
