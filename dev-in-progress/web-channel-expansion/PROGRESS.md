# Feature: ç¶²é é€šé“æ“´å±•

**ç‹€æ…‹**: ğŸ”„ é€²è¡Œä¸­  
**é–‹å§‹æ™‚é–“**: 2026-01-08  
**è² è²¬ Agent**: Cline AI

---

## ğŸ“‹ ä»»å‹™æ¸…å–®

### Phase 1: åŸºç¤è¨­æ–½æº–å‚™ï¼ˆWeek 1ï¼‰
- [ ] è¨­è¨ˆçµ±ä¸€æ­·å²è¨˜éŒ„æ¶æ§‹ï¼ˆTelegram + Web å…±ç”¨ï¼‰
- [ ] å‰µå»º web_users tableï¼ˆemail PKï¼‰
- [ ] ä¿ç•™ allowlist tableï¼ˆTelegram å°ˆç”¨ï¼Œä¸ä¿®æ”¹ï¼‰
- [ ] å‰µå»º user_bindings tableï¼ˆUUIDï¼‰
- [ ] å‰µå»º binding_codes tableï¼ˆ6ä½æ•¸é©—è­‰ç¢¼ï¼‰
- [ ] å‰µå»º conversation_history tableï¼ˆ90å¤© TTLï¼‰
- [ ] å‰µå»º websocket_connections table
- [ ] è¨­ç½® Secrets Managerï¼ˆJWT secretï¼‰
- [ ] å‰µå»º WebSocket + REST API Gateway

### Phase 2: èªè­‰ç³»çµ±é–‹ç™¼ï¼ˆWeek 2ï¼‰
- [ ] å¯¦ç¾ Web Auth Lambdaï¼ˆemail/passwordï¼‰
- [ ] å¯¦ç¾ Lambda Authorizerï¼ˆJWT localStorageï¼‰
- [ ] å¯¦ç¾ Admin APIï¼ˆå‰µå»º Web å¸³è™Ÿï¼‰
- [ ] å¯¦ç¾çµ±ä¸€æ¬Šé™æª¢æŸ¥ï¼ˆtelegram + webï¼‰
- [ ] å¯¦ç¾ Rate Limitingï¼ˆ5æ¬¡å¤±æ•—é–15åˆ†é˜ï¼‰
- [ ] å¯¦ç¾å¯†ç¢¼å®‰å…¨ï¼ˆbcryptï¼‰
- [ ] å¯¦ç¾ JWT tokenï¼ˆ7å¤©æœ‰æ•ˆæœŸï¼‰

### Phase 3: Backend æ ¸å¿ƒæœå‹™ï¼ˆWeek 3-4ï¼‰
- [ ] å¯¦ç¾ unified_user_id è§£æï¼ˆUUIDï¼‰
- [ ] ä¿®æ”¹ Memory Serviceï¼ˆä½¿ç”¨ unified_user_idï¼‰
- [ ] ä¿®æ”¹ Response Routerï¼ˆä¿å­˜æ­·å²ï¼‰
- [ ] é–‹ç™¼ History Serviceï¼ˆæ™‚é–“åˆ†çµ„ + åˆ†é ï¼‰
- [ ] é–‹ç™¼ Binding Serviceï¼ˆ6ä½æ•¸é©—è­‰ç¢¼ + 5åˆ†é˜ï¼‰
- [ ] é–‹ç™¼ Web Adapter Lambda
- [ ] é–‹ç™¼ Export Serviceï¼ˆJSON + Markdownï¼‰
- [ ] æ–°å¢ Telegram /bind æŒ‡ä»¤
- [ ] å¯¦ç¾ WebSocket é€£æ¥ç®¡ç†ï¼ˆæœ€æ–°é€£æ¥å„ªå…ˆï¼‰

### Phase 4: å‰ç«¯é–‹ç™¼ï¼ˆWeek 5-6ï¼‰
- [ ] è¨­ç½® React + Vite + TypeScript
- [ ] å¯¦ç¾èªè­‰ç•Œé¢ï¼ˆemail + password + localStorageï¼‰
- [ ] å¯¦ç¾å³æ™‚èŠå¤©ï¼ˆåƒè€ƒ ChatGPT UIï¼‰
- [ ] å¯¦ç¾å°è©±åˆ—è¡¨ï¼ˆæ™‚é–“åˆ†çµ„ï¼Œç„¡ AI æ¨™é¡Œï¼‰
- [ ] å¯¦ç¾æ­·å²æŸ¥çœ‹ï¼ˆåˆ†é è¼‰å…¥ï¼‰
- [ ] å¯¦ç¾å¸³è™Ÿç¶å®šï¼ˆé¡¯ç¤ºé©—è­‰ç¢¼ï¼‰
- [ ] å¯¦ç¾å°è©±å°å‡ºï¼ˆJSON + Markdown + 90å¤©æé†’ï¼‰
- [ ] å¯¦ç¾æš—è‰²æ¨¡å¼ï¼ˆé è¨­ï¼‰
- [ ] PWA åŸºç¤ï¼ˆmanifest + é›¢ç·šæç¤ºï¼‰
- [ ] éŸ¿æ‡‰å¼è¨­è¨ˆï¼ˆmobile-firstï¼‰
- [ ] WebSocket é‡é€£é‚è¼¯
- [ ] æ•´åˆ Tailwind CSS + shadcn/ui

### Phase 5: å¾Œå°ç®¡ç†ç•Œé¢ï¼ˆWeek 6ï¼‰
- [ ] ç”¨æˆ¶ç®¡ç†ï¼ˆWeb usersï¼‰
- [ ] å‰µå»ºå¸³è™Ÿï¼ˆemail + è‡¨æ™‚å¯†ç¢¼ï¼‰
- [ ] æ‰‹å‹•å¯†ç¢¼é‡ç½®ï¼ˆAdmin onlyï¼‰
- [ ] æ¬Šé™ç®¡ç†
- [ ] ç¶å®šç‹€æ…‹æŸ¥çœ‹
- [ ] åŸºæœ¬å¯©è¨ˆæ—¥èªŒ

### Phase 6: æ•´åˆèˆ‡æ¸¬è©¦ï¼ˆWeek 7ï¼‰
- [ ] èªè­‰æµç¨‹æ¸¬è©¦
- [ ] è·¨é€šé“ç¶å®šæ¸¬è©¦
- [ ] Memory å…±äº«æ¸¬è©¦
- [ ] æ­·å²è¨˜éŒ„åŒæ­¥æ¸¬è©¦
- [ ] å°å‡ºåŠŸèƒ½æ¸¬è©¦
- [ ] PWA åŠŸèƒ½æ¸¬è©¦
- [ ] æš—è‰²æ¨¡å¼æ¸¬è©¦
- [ ] WebSocket é‡é€£æ¸¬è©¦
- [ ] å–®è¨­å‚™é€£æ¥æ¸¬è©¦
- [ ] å®‰å…¨æ¸¬è©¦ï¼ˆJWT + bcrypt + Rate Limitingï¼‰
- [ ] ç«¯åˆ°ç«¯æ¸¬è©¦
- [ ] æ€§èƒ½æ¸¬è©¦

### Phase 7: éƒ¨ç½²èˆ‡ç›£æ§ï¼ˆWeek 8ï¼‰
- [ ] ç·¨å¯« IaC (SAM/CloudFormation)
- [ ] é…ç½® CloudFrontï¼ˆåƒ…éœæ…‹è³‡æºï¼‰
- [ ] è¨­ç½®ç›£æ§å’Œå‘Šè­¦
- [ ] é…ç½®éŒ¯èª¤æ¢å¾©ï¼ˆDLQï¼‰
- [ ] ç·¨å¯«ç”¨æˆ¶æ–‡æª”
- [ ] ç·¨å¯«ç®¡ç†å“¡æ–‡æª”
- [ ] ä¸Šç·šéƒ¨ç½²

---

## ğŸ¯ ç›®æ¨™

### ä¸»è¦ç›®æ¨™
- ç‚º AgentCoreNexus æ·»åŠ  Web é€šé“æ”¯æ´
- å¯¦ç¾è·¨é€šé“ï¼ˆTelegram + Webï¼‰çš„çµ±ä¸€ç”¨æˆ¶é«”é©—
- æä¾›å¯å›é¡§çš„å°è©±æ­·å²è¨˜éŒ„
- æ”¯æ´è·¨é€šé“å¸³è™Ÿç¶å®šï¼Œå…±äº« Memory å’Œæ­·å²

### æŠ€è¡“ç›®æ¨™
- ä¿æŒç¾æœ‰ Telegram åŠŸèƒ½å®Œå…¨ä¸å—å½±éŸ¿
- ä½¿ç”¨ DynamoDB ç°¡åŒ–èªè­‰ï¼ˆç„¡éœ€ Cognitoï¼‰
- å¯¦ç¾ PWA æä¾›é¡åŸç”Ÿæ‡‰ç”¨é«”é©—
- ç¢ºä¿å®‰å…¨æ€§å’Œæ€§èƒ½

---

## ğŸ“ æ ¸å¿ƒæ¶æ§‹

### æ•¸æ“šæ¨¡å‹

#### 1. web_users (æ–°å¢)
```python
{
  'email': 'user@example.com',  # PK
  'password_hash': 'bcrypt...',
  'web_session_token': 'jwt...',
  'enabled': True,
  'role': 'user|admin',
  'created_at': timestamp
}
```

#### 2. allowlist (ç¾æœ‰ï¼Œä¿æŒä¸è®Š)
```python
{
  'chat_id': 123456,  # PK - Telegram chat_id
  'username': 'telegram_user',
  'enabled': True,
  'role': 'user|admin'
}
```

#### 3. user_bindings (æ–°å¢)
```python
{
  'unified_user_id': 'uuid-xxxx',  # PK - UUID
  'telegram_chat_id': 123456,      # å¯é¸
  'web_email': 'user@example.com', # å¯é¸
  'binding_status': 'complete',
  'created_at': timestamp
}
```

#### 4. conversation_history (æ–°å¢)
```python
{
  'unified_user_id': 'uuid-xxxx',  # PK
  'timestamp_msgid': 'ISO8601#uuid', # SK
  'role': 'user|assistant',
  'content': {...},
  'channel': 'web|telegram',
  'ttl': timestamp + 90days
}
```

### æ¶ˆæ¯æµ
```
Web Frontend (React PWA)
  â†“ WebSocket + REST API
API Gateway (Lambda Authorizer)
  â†“
Web Adapter Lambda
  â†“ EventBridge (çµ±ä¸€æ¶ˆæ¯æ ¼å¼)
Processor Lambda (AgentCore + Memory)
  â†“ EventBridge
Response Router Lambda
  â†“
WebSocket å›å‚³ + æ­·å²è¨˜éŒ„ä¿å­˜
```

---

## ğŸ“ é—œéµè¨­è¨ˆæ±ºç­–

### å·²ç¢ºèªæ±ºç­–
1. **æ•¸æ“šæ¨¡å‹**ï¼šweb_users + allowlist åˆ†é–‹ç®¡ç†ï¼Œuser_bindings é€£æ¥
2. **ç”¨æˆ¶è­˜åˆ¥**ï¼šWeb ç”¨ emailï¼ŒTelegram ç”¨ chat_idï¼Œçµ±ä¸€ç”¨ UUID
3. **èªè­‰æ–¹å¼**ï¼šDynamoDB + JWTï¼ˆlocalStorageï¼Œ7å¤©ï¼‰ï¼Œç„¡ Cognito
4. **å°è©±åˆ†çµ„**ï¼šæŒ‰æ™‚é–“è‡ªå‹•åˆ†çµ„ï¼ˆä»Šå¤©/æ˜¨å¤©/æœ¬é€±/æ›´æ—©ï¼‰
5. **WebSocket**ï¼šMVP åªæ”¯æ´å–®è¨­å‚™ï¼ˆæœ€æ–°é€£æ¥å„ªå…ˆï¼‰
6. **æ­·å²ä¿ç•™**ï¼š90å¤© TTL + å°å‡ºæé†’
7. **é›¢ç·šæ”¯æ´**ï¼šPWA åŸºç¤ï¼ˆmanifest + é›¢ç·šæç¤ºï¼‰
8. **å¯†ç¢¼é‡ç½®**ï¼šMVP ç”¨ Admin æ‰‹å‹•é‡ç½®
9. **å‰ç«¯æŠ€è¡“**ï¼šReact + Vite + TypeScript + Tailwind + shadcn/ui
10. **CloudFront**ï¼šåƒ…ç”¨æ–¼éœæ…‹è³‡æº

### å»¶å¾Œåˆ° Phase 2
- AI ç”Ÿæˆå°è©±æ¨™é¡Œ
- å¤šè¨­å‚™æ¶ˆæ¯å»£æ’­
- é›¢ç·šæ¶ˆæ¯éšŠåˆ—
- Email å¯†ç¢¼é‡ç½®
- æª”æ¡ˆä¸Šå‚³åŠŸèƒ½
- PDF å°å‡º
- å°è©±æ°¸ä¹…ä¿å­˜

---

## âš ï¸ å•é¡Œèˆ‡é¢¨éšª

### å·²è­˜åˆ¥é¢¨éšª
1. **WebSocket é€£æ¥ç®¡ç†**ï¼šéœ€è¦è™•ç†æ–·ç·šé‡é€£å’Œæ¸…ç†éæœŸé€£æ¥
2. **Memory Service ä¿®æ”¹**ï¼šéœ€è¦ç¢ºä¿ä¸å½±éŸ¿ç¾æœ‰ Telegram ç”¨æˆ¶
3. **å¤šè¡¨æŸ¥è©¢æ€§èƒ½**ï¼šweb_users + bindings éœ€è¦å„ªåŒ–æŸ¥è©¢è·¯å¾‘
4. **JWT localStorage**ï¼šæœ‰ XSS é¢¨éšªï¼Œä½†å…§éƒ¨ç³»çµ±å¯æ¥å—

### ç·©è§£æªæ–½
- å……åˆ†æ¸¬è©¦ Memory Service ä¿®æ”¹
- å¯¦ç¾ç´¢å¼•å„ªåŒ–å¤šè¡¨æŸ¥è©¢
- å¯¦æ–½åš´æ ¼çš„è¼¸å…¥é©—è­‰é˜² XSS
- ä½¿ç”¨çŸ­æœŸ token + å¯©è¨ˆæ—¥èªŒ

---

## ğŸ“Š é€²åº¦è¿½è¹¤

**ç•¶å‰éšæ®µ**: Phase 1 - åŸºç¤è¨­æ–½æº–å‚™  
**å®Œæˆé€²åº¦**: 0/67 é … (0%)  
**é è¨ˆå®Œæˆ**: 2026-03-08 (8é€±)

---

## ğŸ“ é–‹ç™¼ç­†è¨˜

### 2026-01-08
- âœ… å®Œæˆéœ€æ±‚åˆ†æå’ŒæŠ€è¡“æ±ºç­–
- âœ… ç¢ºå®šæ•¸æ“šæ¨¡å‹å’Œæ¶æ§‹è¨­è¨ˆ
- âœ… å‰µå»ºé–‹ç™¼ç›®éŒ„å’Œé€²åº¦è¿½è¹¤
- ğŸ”„ æº–å‚™é–‹å§‹ Phase 1 å¯¦æ–½